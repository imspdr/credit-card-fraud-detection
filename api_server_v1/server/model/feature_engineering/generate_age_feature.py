import pandas as pd

age_dict = {
    "~20": [97032797689821735,
            2027553650310142703,
            7035602569409149834,
            -7421093378627544099,
            -5467922351692495955,
            1799189980464955940,
            4241336128694185533,
            -5475680618560174533,
            -4282466774399734331,
            1913477460590765860,],
    "~40": [-3345936507911876459,
            97032797689821735,
            7035602569409149834,
            2027553650310142703,
            -7421093378627544099,
            1799189980464955940,
            4241336128694185533,
            -5475680618560174533,
            -4282466774399734331,
            1913477460590765860,],
    "~60": [-1288082279022882052,
            -5162038175624867091,
            1799189980464955940,
            2027553650310142703,
            -7146670748125200898,
            -3220758452254689706,
            -7421093378627544099,
            -5475680618560174533,
            7035602569409149834,
            1913477460590765860,],
    "60+": [208649686760524778,
            -5162038175624867091,
            97032797689821735,
            7035602569409149834,
            -7146670748125200898,
            -7421093378627544099,
            -3220758452254689706,
            2027553650310142703,
            -5475680618560174533,
            1913477460590765860,]
}

def age_group(age):
    if age < 20:
        return "~20"
    elif age < 40:
        return "~40"
    elif age < 60:
        return "~60"
    else:
        return "60+"

def generate_age_feature(df: pd.DataFrame) -> pd.DataFrame:
    # 1. Merchant name in
    df.loc[:, "Age Group"] = df["Current Age"].apply(age_group)
    df.loc[:, "Merchant In Age"] = df.apply(lambda row: 1 if row["Merchant Name"] in age_dict[row["Age Group"]] else 0, axis=1)
    df = df.drop(["Age Group", "Merchant Name"], axis=1)
    return df